{% extends "ticket/dashboard.html" %}
{% load staticfiles %}

{% load crispy_forms_tags %}
{#{% load material_form %}#}
{% block css %}
    <script src="{% static 'plugins/echarts/echarts.common.min.js' %}"></script>
{% endblock %}
{% block content %}
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            入池额度比例
            <small>配置</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
            <li class="active">入池额度比例</li>
        </ol>
    </section>

    <section class="content">
        <div class="row">
            <div class="col-md-12">
                <form method='POST' class="form-inline" action=''>{% csrf_token %}
                    <label for="id_task_title" class="control-label"><h4 class="center-block"> 当前入池额度比例：<big><span
                            class="text-primary">{{ item.inpoolPer }}</span></big>%</h4></label>
                    <div class="input-group">
                        <span class="input-group-addon">更改为：</span>
                        <input type="number" name="inpoolPer" step="any"
                               class="numberinput form-control" required="">
                        <span class="input-group-addon">%</span>
                    </div>
                    <input class="btn btn-primary" value="提交" type="submit">

                </form>
            </div>
        </div>
            <br/>
        <div class="row">
            <!-- left column -->
            <div class="col-md-6">
                <div id="main" style="width: 600px;height:400px;"></div>
                <script>

                    // 绘制图表。
                    echarts.init(document.getElementById('main')).setOption({
                        title: {
                            text: '入池额度比例变化情况'
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow',
                                label: {
                                    show: true,
                                    backgroundColor: '#333'
                                }
                            }
                        },
                        xAxis: {
                            type: 'category',
                            axisLine: {
                                lineStyle: {
                                    color: '#222'
                                }
                            },
                            data: [{% for item in items_date %}
                                '{{ item }}'{% if not forloop.last %},{% endif %}
                            {% endfor %}]
                        },
                        yAxis: {
                            splitLine: {show: false},
                            axisLine: {
                                lineStyle: {
                                    color: '#222'
                                }
                            }
                        },
                        series: [{
                            name: '比例(%)',
                            type: 'line',
                            smooth: true,
                            showAllSymbol: true,
                            symbol: 'emptyCircle',
                            symbolSize: 15,
                            data: [{% for item in items_total %}
                                {{ item }}  {% if not forloop.last %},{% endif %}
                            {% endfor %}],
                        }]
                    });
                </script>

            </div>
            <div class="col-md-6">

                <div class="row">
                    <div>
                        <table id="table_id" class="table table-striped table-bordered table-hover">
                            <thead>
                            <!--表格头部-->
                            <th>比例(%)</th>
                            <th>添加日期</th>
                            </thead>
                            <!--表格内容-->
                            <tbody>
                            {% for i in data %}
                                <tr>
                                    <td>{{ i.inpoolPer }}</td>
                                    <td>{{ i.pub_date }}</td>
                                </tr>

                            {% endfor %}

                            </tbody>
                        </table>
                    </div>
                    <!--引入modal.html-->
                    {% include 'ticket/modal.html' %}
                    <!--引入pagination.html-->
                    {% include 'ticket/pagination.html' %}
                </div>

            </div>


        </div>
    </section>

{% endblock %}

