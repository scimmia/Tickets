{% extends "ticket/dashboard.html" %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block css %}
    <link rel="stylesheet" href="{% static 'plugins/select2/select2.min.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/datatables/jquery.dataTables.min.css' %}">

{% endblock %}
{% block content %}
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            {% if isloan %}贷款{% else %}借款{% endif %}人
            <small>{{ jiedairen }}</small>
        </h1>

        <ol class="breadcrumb">
            <button utton type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
                新建{% if isloan %}贷款{% else %}借款{% endif %}
                <i class="ace-icon fa fa-shopping-cart icon-on-right bigger-110"></i>
            </button>
        </ol>
    </section>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">新建{% if isloan %}贷款{% else %}借款{% endif %}</h4>
                </div>
                <form method='POST' id="signupForm" action="" onsubmit="return check();">{% csrf_token %}
                    <div class="modal-body">
                        {{ loanform | crispy }}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="submit" class="btn btn-primary">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <section class="content">
        {% block search_header %}
        {% endblock %}
        <div class="row">
            <div class="col-md-12">
                <table id="table_id" class="table table-striped table-bordered table-hover">
                    <thead>
                    <!--表格头部-->
                    <th>添加日期</th>
                    <th>本金</th>
                    <th>已{% if isloan %}还{% else %}收{% endif %}本金</th>
                    <th>待{% if isloan %}还{% else %}收{% endif %}本金</th>
                    <th>利率</th>
                    <th>计息日期</th>
                    <th>累计利息</th>
                    <th>已{% if isloan %}还{% else %}收{% endif %}利息</th>
                    <th>待{% if isloan %}还{% else %}收{% endif %}利息</th>
                    </thead>
                    <!--表格内容-->
                    <tbody>
                    {% for item in data %}
                        <tr>
                            <td><a class="green" href="{% url 'loanorder' item.id %}" title="查看信息">
                                {{ item.pub_date }}
                            </a></td>
                            <td>{{ item.money_benjin|floatformat:2|intcomma }}</td>
                            <td>{{ item.payed_benjin|floatformat:2|intcomma }}</td>
                            <td {% if item.needpay_sum > 0 %}style="color: red"{% endif %}>{{ item.needpay_sum|floatformat:2|intcomma }}</td>
                            <td>{{ item.money_lilv }}</td>
                            <td>{{ item.order_date }}</td>
                            <td>{{ item.totallixi|floatformat:2|intcomma }}</td>
                            <td>{{ item.payed_lixi|floatformat:2|intcomma }}</td>
                            <td {% if item.needpay_lixi > 0 %}style="color: red"{% endif %}>{{ item.needpay_lixi|floatformat:2|intcomma }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </section>

{% endblock %}

{% block script %}
    <script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'plugins/datatables/dataTables.bootstrap.js' %}"></script>
    <script src="{% static 'plugins/datepicker/bootstrap-datepicker.js' %}"></script>
    <script type="text/javascript">
        $(function () {
            var t = $('#table_id').DataTable({
                'paging': false,
                'lengthChange': false,
                'searching': true,
                'ordering': true,
                'info': true,
                'autoWidth': false,
                'scrollY': 450,
                "language": {
                    "processing": "处理中...",
                    "lengthMenu": "显示 _MENU_ 项结果",
                    "zeroRecords": "没有匹配结果",
                    "info": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "infoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "infoFiltered": "(由 _MAX_ 项结果过滤)",
                    "infoPostFix": "",
                    "search": "搜索:",
                    "searchPlaceholder": "搜索...",
                    "url": "",
                    "emptyTable": "表中数据为空",
                    "loadingRecords": "载入中...",
                    "infoThousands": ",",
                    "paginate": {
                        "first": "首页",
                        "previous": "上页",
                        "next": "下页",
                        "last": "末页"
                    },
                    "aria": {
                        "paginate": {
                            'first': '首页',
                            'previous': '上页',
                            'next': '下页',
                            'last': '末页'
                        },
                        "sortAscending": ": 以升序排列此列",
                        "sortDescending": ": 以降序排列此列"
                    },
                    "decimal": "-",
                    "thousands": "."
                },
            });

        });

        //Date picker
        $.fn.datepicker.dates['cn'] = {   //切换为中文显示
            days: ["周日", "周一", "周二", "周三", "周四", "周五", "周六", "周日"],
            daysShort: ["日", "一", "二", "三", "四", "五", "六", "七"],
            daysMin: ["日", "一", "二", "三", "四", "五", "六", "七"],
            months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
            monthsShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
            today: "今天",
            clear: "清除"
        };
        $('.dateinput').datepicker({
            autoclose: true, //自动关闭
            clearBtn: true,          //显示清除按钮
            format: 'yyyy-mm-dd',
            language: 'cn',           //语言
        });
    </script>


{% endblock %}