{% extends "ticket/dashboard.html" %}
{% load staticfiles %}

{% load crispy_forms_tags %}
{#{% load material_form %}#}
{% block css %}
    <script src="{% static 'plugins/echarts/echarts.common.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'plugins/datatables/jquery.dataTables.min.css' %}">
{% endblock %}
{% block content %}
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            入池额度比例
            <small>配置</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
            <li class="active">入池额度比例</li>
        </ol>
    </section>

    <section class="content">
        <div class="row">
            <!-- left column -->
            <div class="col-md-6">
                <form method='POST' class="form-inline" action=''>{% csrf_token %}
                    <label for="id_task_title" class="control-label"><h4 class="center-block"> 当前入池额度比例：<big><span
                            class="text-primary">{{ item.inpoolPer }}</span></big>%</h4></label>
                    <div class="input-group">
                        <span class="input-group-addon">更改为：</span>
                        <input type="number" name="inpoolPer" step="any" max="100" min="0"
                               class="numberinput form-control" required="">
                        <span class="input-group-addon">%</span>
                    </div>
                    <input class="btn btn-primary" value="提交" type="submit">

                </form>
                <div id="main" style="width: 600px;height:400px;"></div>
                <script>
                    // 绘制图表。
                    echarts.init(document.getElementById('main')).setOption({
                        title: {
                            text: '入池额度比例变化情况'
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow',
                                label: {
                                    show: true,
                                    backgroundColor: '#333'
                                }
                            }
                        },
                        xAxis: {
                            type: 'category',
                            axisLine: {
                                lineStyle: {
                                    color: '#222'
                                }
                            },
                            data: [{% for item in items_date %}
                                '{{ item }}'{% if not forloop.last %},{% endif %}
                            {% endfor %}]
                        },
                        yAxis: {
                            splitLine: {show: false},
                            axisLine: {
                                lineStyle: {
                                    color: '#222'
                                }
                            }
                        },
                        series: [{
                            name: '比例(%)',
                            type: 'line',
                            smooth: true,
                            showAllSymbol: true,
                            symbol: 'emptyCircle',
                            symbolSize: 15,
                            data: [{% for item in items_total %}
                                {{ item }}  {% if not forloop.last %},{% endif %}
                            {% endfor %}],
                        }]
                    });
                </script>

            </div>
            <div class="col-md-6">

                <div class="row">
                    <div>
                        <table id="table_id" class="table table-striped table-bordered table-hover">
                            <thead>
                            <!--表格头部-->
                            <th>比例(%)</th>
                            <th>添加时间</th>
                            </thead>
                            <!--表格内容-->
                            <tbody>
                            {% for i in data %}
                                <tr>
                                    <td>{{ i.inpoolPer }}</td>
                                    <td>{{ i.pub_date }}</td>
                                </tr>

                            {% endfor %}

                            </tbody>
                        </table>
                    </div>
                </div>

            </div>


        </div>
    </section>

{% endblock %}

{% block script %}
    <script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'plugins/datatables/dataTables.bootstrap.js' %}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#table_id').DataTable({
                'paging': true,
                'lengthChange': false,
                'searching': true,
                'ordering': false,
                'info': true,
                'autoWidth': false,
                'scrollY': 410,
                "language": {
                    "processing": "处理中...",
                    "lengthMenu": "显示 _MENU_ 项结果",
                    "zeroRecords": "没有匹配结果",
                    "info": "",
                    "infoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "infoFiltered": "(由 _MAX_ 项结果过滤)",
                    "infoPostFix": "",
                    "search": "搜索:",
                    "searchPlaceholder": "搜索...",
                    "url": "",
                    "emptyTable": "表中数据为空",
                    "loadingRecords": "载入中...",
                    "infoThousands": ",",
                    "paginate": {
                        "first": "首页",
                        "previous": "上页",
                        "next": "下页",
                        "last": "末页"
                    },
                    "aria": {
                        "paginate": {
                            'first': '首页',
                            'previous': '上页',
                            'next': '下页',
                            'last': '末页'
                        },
                        "sortAscending": ": 以升序排列此列",
                        "sortDescending": ": 以降序排列此列"
                    },
                }
            });
        });
    </script>

{% endblock %}